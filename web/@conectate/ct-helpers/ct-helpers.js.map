{"version":3,"file":"ct-helpers.js","sourceRoot":"","sources":["src/ct-helpers.ts"],"names":[],"mappings":"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","sourcesContent":["export interface UAClientDescription {\n\tbrowser: 'firefox' | 'edge' | 'chrome' | 'facebook' | 'google_app' | 'ie' | 'safari' | 'safari_mobile' | 'other';\n\tbrowserVersion: number;\n\tisMobile: boolean;\n\tos: 'ios' | 'android' | 'linux' | 'mac' | 'windows' | 'playstation' | 'other';\n\tosVersion: number;\n}\n/**\n * Get Client description for a user agent string.\n */\nexport function getClient(ua?: string) {\n\tinterface os {\n\t\tregex: RegExp;\n\t\tos: 'ios' | 'android' | 'linux' | 'mac' | 'windows' | 'playstation' | 'other';\n\t\tapply: Function;\n\t}\n\tinterface browser {\n\t\tbrowser: 'firefox' | 'edge' | 'chrome' | 'facebook' | 'google_app' | 'ie' | 'safari' | 'safari_mobile' | 'other';\n\t\tregex: RegExp;\n\t}\n\n\tlet o: UAClientDescription = {\n\t\tbrowser: 'other',\n\t\tbrowserVersion: 0,\n\t\tisMobile: false,\n\t\tos: 'other',\n\t\tosVersion: 0\n\t};\n\tua = ua || navigator.userAgent;\n\tlet a: browser[] = [\n\t\t{ browser: 'facebook', regex: /FBAV\\/([0-9\\.]+)/i },\n\t\t{ browser: 'facebook', regex: /FBSV\\/([0-9\\.]+)/i },\n\t\t{ browser: 'google_app', regex: /GSA\\/([0-9\\.]+)/i },\n\t\t{ browser: 'firefox', regex: /Firefox\\/([0-9\\.]+)/i },\n\t\t{ browser: 'firefox', regex: /FxiOS\\/([0-9\\.]+)/i },\n\t\t{ browser: 'edge', regex: /Edge\\/([0-9\\.]+)/i },\n\t\t{ browser: 'chrome', regex: /Chrome\\/([0-9\\.]+)/i },\n\t\t{ browser: 'chrome', regex: /CriOS\\/([0-9\\.]+)/i },\n\t\t{ browser: 'ie', regex: /Trident\\/.+rv[: ]?([0-9]+)/i },\n\t\t{ browser: 'safari', regex: /Version\\/([0-9\\.]+).+Safari/ }\n\t];\n\tfor (let i = 0; i < a.length; i++) {\n\t\tlet reg = ua.match(a[i].regex);\n\t\tif (reg) {\n\t\t\to.browser = a[i].browser;\n\t\t\to.browserVersion = parseFloat(reg[1]);\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (ua.match(/Mobile/)) {\n\t\to.isMobile = true;\n\t}\n\tlet opSys: os[] = [\n\t\t{\n\t\t\tos: 'ios',\n\t\t\tregex: /([0-9_]+) like Mac OS X/,\n\t\t\tapply: (v: string) => v.replace(/_/g, '.')\n\t\t},\n\t\t{\n\t\t\tos: 'ios',\n\t\t\tregex: /CPU like Mac OS X/,\n\t\t\tapply: () => '0'\n\t\t},\n\t\t{\n\t\t\tos: 'android',\n\t\t\tregex: /Android ([0-9\\.]+)/,\n\t\t\tapply: (v: string) => v\n\t\t},\n\t\t{\n\t\t\tos: 'linux',\n\t\t\tregex: /Linux (x86_64|x86)/,\n\t\t\tapply: (v: string) => (v == 'x86_64' ? '64' : '32')\n\t\t},\n\t\t{\n\t\t\tos: 'mac',\n\t\t\tregex: /Macintosh.+Mac OS X ([0-9_]+)/,\n\t\t\tapply: (v: string) => v.replace(/_/g, '.')\n\t\t},\n\t\t{\n\t\t\tos: 'windows',\n\t\t\tregex: /Windows NT ([0-9\\.]+)/,\n\t\t\tapply: (v: string) => v.replace(/_/g, '.')\n\t\t},\n\t\t{\n\t\t\tos: 'playstation',\n\t\t\tregex: /PlayStation ([0-9\\.]+)/,\n\t\t\tapply: (v: string) => v.replace(/_/g, '.')\n\t\t}\n\t];\n\tfor (let i = 0; i < opSys.length; i++) {\n\t\tlet reg = ua.match(opSys[i].regex);\n\t\tif (reg) {\n\t\t\to.os = opSys[i].os;\n\t\t\to.osVersion = reg.length > 1 ? parseFloat(opSys[i].apply(reg[1])) : 0;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn o;\n}\n\n/**\n * Return the set of capabilities for a user agent string.\n */\nexport function browserCapabilities(userAgent: string) {\n\t/**\n\t * Return whether `version` is at least as high as `atLeast`.\n\t */\n\tfunction versionAtLeast(atLeast: number[], browserVersion: number[]) {\n\t\tfor (let i = 0; i < atLeast.length; i++) {\n\t\t\tconst r = atLeast[i];\n\t\t\tconst v = browserVersion.length > i ? browserVersion[i] : 0;\n\t\t\tif (v > r) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (v < r) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t/**\n\t * Parse a \"x.y.z\" version string of any length into integer parts. Returns -1\n\t * for a part that doesn't parse.\n\t */\n\tfunction parseVersion(version?: number) {\n\t\tif (!version) {\n\t\t\treturn [];\n\t\t}\n\t\treturn new String(version).split('.').map(part => {\n\t\t\tconst i = parseInt(part, 10);\n\t\t\treturn isNaN(i) ? -1 : i;\n\t\t});\n\t}\n\t/**\n\t * Make a predicate that checks if the browser version is at least this high.\n\t */\n\tfunction since(...atLeast: number[]) {\n\t\treturn (ua: UAClientDescription) => versionAtLeast(atLeast, parseVersion(ua.browserVersion));\n\t}\n\t/**\n\t * Make a predicate that checks if the OS version is at least this high.\n\t */\n\tfunction sinceOS(...atLeast: number[]) {\n\t\treturn (ua: UAClientDescription) => versionAtLeast(atLeast, parseVersion(ua.osVersion));\n\t}\n\tconst chrome = {\n\t\tes2015: since(49),\n\t\tes2016: since(58),\n\t\tes2017: since(58),\n\t\tes2018: since(64),\n\t\tcustomElementsV1: since(54),\n\t\tpush: since(41),\n\t\tserviceworker: since(45),\n\t\tmodules: since(64)\n\t};\n\tconst browserPredicates = {\n\t\tchrome: chrome,\n\t\topera: {\n\t\t\tes2015: since(36),\n\t\t\tes2016: since(45),\n\t\t\tes2017: since(45),\n\t\t\tes2018: since(51),\n\t\t\tcustomElementsV1: since(41),\n\t\t\tpush: since(28),\n\t\t\tserviceworker: since(32),\n\t\t\tmodules: since(48)\n\t\t},\n\t\tvivaldi: {\n\t\t\tes2015: since(1),\n\t\t\tes2016: since(1, 14),\n\t\t\tes2017: since(1, 14),\n\t\t\tes2018: since(1, 14),\n\t\t\tcustomElementsV1: since(1),\n\t\t\tpush: since(1),\n\t\t\tserviceworker: since(1),\n\t\t\tmodules: since(1, 14)\n\t\t},\n\t\tsafari_mobile: {\n\t\t\tes2015: sinceOS(10),\n\t\t\tes2016: sinceOS(10, 3),\n\t\t\tes2017: sinceOS(10, 3),\n\t\t\tes2018: sinceOS(11, 3),\n\t\t\tcustomElementsV1: since(10, 3),\n\t\t\tpush: sinceOS(9, 2),\n\t\t\tserviceworker: sinceOS(11, 3),\n\t\t\tmodules: sinceOS(11, 3)\n\t\t},\n\t\tsafari: {\n\t\t\tes2015: since(10),\n\t\t\tes2016: since(10, 1),\n\t\t\tes2017: since(10, 1),\n\t\t\tes2018: sinceOS(11, 1),\n\t\t\tcustomElementsV1: since(10, 1),\n\t\t\tpush: (ua: UAClientDescription) => {\n\t\t\t\treturn (\n\t\t\t\t\tversionAtLeast([9], parseVersion(ua.browserVersion)) &&\n\t\t\t\t\t// HTTP/2 on desktop Safari requires macOS 10.11 according to\n\t\t\t\t\t// caniuse.com.\n\t\t\t\t\tversionAtLeast([10, 11], parseVersion(ua.osVersion))\n\t\t\t\t);\n\t\t\t},\n\t\t\t// https://webkit.org/status/#specification-service-workers\n\t\t\tserviceworker: since(11, 1),\n\t\t\tmodules: since(11, 1)\n\t\t},\n\t\tedge: {\n\t\t\t// Edge versions before 15.15063 may contain a JIT bug affecting ES6\n\t\t\t// constructors (https://github.com/Microsoft/ChakraCore/issues/1496).\n\t\t\t// Since this bug was fixed after es2016 and 2017 support, all these\n\t\t\t// versions are the same.\n\t\t\tes2015: since(15, 15063),\n\t\t\tes2016: since(15, 15063),\n\t\t\tes2017: since(15, 15063),\n\t\t\tes2018: since(18),\n\t\t\tcustomElementsV1: since(79),\n\t\t\tpush: since(12),\n\t\t\tserviceworker: since(79),\n\t\t\tmodules: since(79)\n\t\t},\n\t\tfirefox: {\n\t\t\tes2015: since(51),\n\t\t\tes2016: since(52),\n\t\t\tes2017: since(52),\n\t\t\tes2018: since(58),\n\t\t\tcustomElementsV1: since(63),\n\t\t\t// Firefox bug - https://bugzilla.mozilla.org/show_bug.cgi?id=1409570\n\t\t\tpush: since(63),\n\t\t\tserviceworker: since(44),\n\t\t\tmodules: since(67)\n\t\t}\n\t};\n\ttype tCapabilities = keyof typeof chrome;\n\tconst ua = getClient(userAgent);\n\tconst capabilities = new Set<tCapabilities>();\n\tlet browserName = ua.browser;\n\tif (ua.os === 'ios') {\n\t\t// if iOS is really safari_mobile.\n\t\tbrowserName = 'safari_mobile';\n\t} else if (ua.browser == 'facebook') {\n\t\tbrowserName = 'chrome';\n\t}\n\tconst predicates = browserPredicates[browserName as 'chrome'] || {};\n\tfor (const capability of Object.keys(predicates)) {\n\t\tif (predicates[capability as 'push'](ua)) {\n\t\t\tcapabilities.add(capability as tCapabilities);\n\t\t}\n\t}\n\treturn capabilities;\n}\n/**\n * Get GeoLocation in browser\n */\nexport function getGeoLocation(): Promise<{ lat: number; lon: number }> {\n\treturn new Promise((solve, err) => {\n\t\tif (navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition(\n\t\t\t\tp => {\n\t\t\t\t\tsolve({\n\t\t\t\t\t\tlat: p.coords.latitude,\n\t\t\t\t\t\tlon: p.coords.longitude\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\terr({ error: 'Haz denagado los permisos de ubicación', code: 0 });\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\terr({ error: 'Tu navegador no soporta la Geolocalizacion', code: -1 });\n\t\t}\n\t});\n}\n/**\n * Sleep Promise\n */\nexport let sleep = (time: number) => new Promise(resolve => setTimeout(() => resolve(0), time));\n\n/**\n * Generate Random ID\n */\nexport class PushID {\n\t// Modeled after base64 web-safe chars, but ordered by ASCII.\n\tPUSH_CHARS = '-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz';\n\n\t// Timestamp of last push, used to prevent local collisions if you push twice in one ms.\n\tlastPushTime = 0;\n\n\t// We generate 72-bits of randomness which get turned into 12 characters and appended to the\n\t// timestamp to prevent collisions with other clients.  We store the last characters we\n\t// generated because in the event of a collision, we'll use those same characters except\n\t// \"incremented\" by one.\n\tlastRandChars: number[] = [];\n\n\tnext(length = 20) {\n\t\t// 12\n\t\tlet computeTotal = length - 8;\n\t\tlet now = new Date().getTime();\n\t\tlet duplicateTime = now === this.lastPushTime;\n\t\tthis.lastPushTime = now;\n\n\t\tlet timeStampChars = new Array(8);\n\t\tfor (let i = 7; i >= 0; i--) {\n\t\t\ttimeStampChars[i] = this.PUSH_CHARS.charAt(now % 64);\n\t\t\t// NOTE: Can't use << here because javascript will convert to int and lose the upper bits.\n\t\t\tnow = Math.floor(now / 64);\n\t\t}\n\t\tif (now !== 0) throw new Error('We should have converted the entire timestamp.');\n\n\t\tlet id = timeStampChars.join('');\n\t\tlet i;\n\t\tif (!duplicateTime) {\n\t\t\tfor (i = 0; i < computeTotal; i++) {\n\t\t\t\tthis.lastRandChars[i] = Math.floor(Math.random() * 64);\n\t\t\t}\n\t\t} else {\n\t\t\t// If the timestamp hasn't changed since last push, use the same random number, except incremented by 1.\n\t\t\tfor (i = computeTotal - 1; i >= 0 && this.lastRandChars[i] === 63; i--) {\n\t\t\t\tthis.lastRandChars[i] = 0;\n\t\t\t}\n\t\t\tthis.lastRandChars[i]++;\n\t\t}\n\t\tfor (i = 0; i < computeTotal; i++) {\n\t\t\tid += this.PUSH_CHARS.charAt(this.lastRandChars[i]);\n\t\t}\n\t\t//if (id.length != 20) throw new Error('Length should be 20.');\n\n\t\treturn id;\n\t}\n\tdecodePushID(str: string) {\n\t\tlet alphabet = this.PUSH_CHARS;\n\t\tif (str[0] == '-') str = str.substring(1, 8);\n\t\tvar decoded = 0;\n\t\twhile (str) {\n\t\t\tvar index = alphabet.indexOf(str[0]);\n\t\t\tvar power = str.length - 1;\n\t\t\tdecoded += index * Math.pow(alphabet.length, power);\n\t\t\tstr = str.substring(1);\n\t\t}\n\t\treturn decoded;\n\t}\n}\n"]}